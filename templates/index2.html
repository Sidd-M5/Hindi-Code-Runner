<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>‡§ï‡•ã‡§°‡§Æ‡•â‡§∞‡•ç‡§´ ‚Äî ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§ï‡•ã‡§° ‡§∞‡§®‡§∞</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/theme/material-darker.min.css">
<style>
:root{--bg:#0f1724;--card:#0b1220;--muted:#9aa4b2;--accent:#60a5fa;--accent-2:#7c3aed;--glass: rgba(255,255,255,0.03);--radius:12px;--mono: ui-monospace, SFMono-Regular, Menlo, Monaco, 'Roboto Mono', 'Consolas', monospace;}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,'Noto Sans',sans-serif;background:linear-gradient(180deg,#071025 0%, #07162a 100%);color:#e6eef6}
.app{max-width:1200px;margin:28px auto;padding:18px}
header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
header h1{font-size:20px;margin:0;letter-spacing:0.2px}
.controls{display:flex;gap:10px;align-items:center}
.btn{background:var(--glass);border:1px solid rgba(255,255,255,0.04);padding:10px 14px;border-radius:10px;color:var(--muted);cursor:pointer;font-weight:600}
.btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;border:none}
.workspace{display:grid;grid-template-columns:1fr 420px;gap:18px}
@media(max-width:980px){.workspace{grid-template-columns:1fr}}
.card{background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent);border:1px solid rgba(255,255,255,0.03);border-radius:var(--radius);padding:16px}
.editor-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.CodeMirror{height:520px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);font-size:15px}
.terminal{display:flex;flex-direction:column;gap:12px}
.term-top{display:flex;align-items:center;gap:10px}
.term-title{font-weight:700}
.term-window{background:#081223;border-radius:12px;padding:12px;border:1px solid rgba(96,165,250,0.06);box-shadow:0 6px 30px rgba(2,6,23,0.6) inset}
.term-output{height:340px;overflow:auto;border-radius:8px;padding:12px;background:linear-gradient(180deg, rgba(3,7,18,0.85), rgba(2,6,23,0.95));font-family:var(--mono);font-size:13px;color:#d6e7ff;line-height:1.5;border:1px solid rgba(255,255,255,0.02)}
.term-output .stdout{color:#d6e7ff}
.term-output .stderr{color:#ef4444;font-weight:700}
.term-output .live-error{color:#f87171;font-weight:700;margin-bottom:4px;}
.explain{background:linear-gradient(180deg, rgba(255,255,255,0.015), transparent);border-radius:10px;padding:10px;border:1px solid rgba(255,255,255,0.03);font-size:13px;color:var(--muted);min-height:60px}
.kb-toggle{position:fixed;right:20px;bottom:20px;z-index:60}
.keyboard{position:fixed;left:50%;transform:translateX(-50%);bottom:-100%;width:96%;max-width:1100px;background:linear-gradient(135deg,#1e293b,#0f172a);border-radius:14px;padding:14px;border:1px solid rgba(255,255,255,0.08);box-shadow:0 30px 60px rgba(2,6,23,0.7);transition:bottom .32s cubic-bezier(.2,.9,.3,1);z-index:50}
.keyboard.open{bottom:22px}
.kb-rows{display:flex;flex-direction:column;gap:8px}
.kb-row{display:flex;gap:6px;justify-content:center;flex-wrap:wrap}
.kb-key{background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.08);padding:8px 12px;border-radius:10px;min-width:44px;text-align:center;cursor:pointer;font-family:var(--mono);user-select:none;color:#e6eef6}
.kb-key.wide{min-width:120px}
.kb-key.func{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:white;border:none}
.kb-key:active{transform:translateY(1px);opacity:.95}
.hint{font-size:12px;color:var(--muted)}
#suggestions { position: absolute; bottom: 220px; left: 10px; right: 10px; background: #222; color: #fff; border-radius: 8px; padding: 5px; display: flex; flex-wrap: wrap; gap: 5px; z-index: 1000; font-family: 'Noto Sans Devanagari', sans-serif;}
#suggestions button { background: #444; border: none; padding: 5px 10px; border-radius: 5px; cursor: pointer; color: white;}
#suggestions button:hover { background: #666;}
</style>
</head>
<body>
<div class="app">
<header>
  <div>
    <h1>‡§ï‡•ã‡§°‡§Æ‡•â‡§∞‡•ç‡§´ ‚Äî ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§ï‡•ã‡§° ‡§∞‡§®‡§∞</h1>
    <div class="small">‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§Æ‡•á‡§Ç ‡§ü‡§æ‡§á‡§™ ‡§ï‡§∞‡•á‡§Ç</div>
  </div>
  <div class="controls">
    <button class="btn" id="examplesBtn">‡§â‡§¶‡§æ‡§π‡§∞‡§£</button>
    <button class="btn" id="clearBtn">‡§∏‡§æ‡§´ ‡§ï‡§∞‡•á‡§Ç</button>
    <button class="btn primary" id="runBtn">‚ñ∂ ‡§ö‡§≤‡§æ‡§è‡§Å</button>
    <button class="btn" id="translateBtn">‡§Ü‡§â‡§ü‡§™‡•Å‡§ü ‚Üí ‡§Ö‡§Ç‡§ó‡•ç‡§∞‡•á‡§ú‡§º‡•Ä</button>
    <button class="btn" id="voiceBtn">üé§ ‡§µ‡•â‡§á‡§∏ ‡§ü‡§æ‡§á‡§™‡§ø‡§Ç‡§ó</button>
  </div>
</header>

<main class="workspace">
  <section class="card">
    <div class="editor-header"><div><div style="font-weight:700">‡§∏‡§Ç‡§™‡§æ‡§¶‡§ï</div></div></div>
    <textarea id="code" placeholder="‡§Ø‡§π‡§æ‡§Å ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§ï‡•ã‡§° ‡§≤‡§ø‡§ñ‡•á‡§Ç ‚Äî ‡§â‡§¶‡§æ‡§π‡§∞‡§£: \n‡§õ‡§æ‡§™‡•á‡§Ç('‡§®‡§Æ‡§∏‡•ç‡§§‡•á ‡§¶‡•Å‡§®‡§ø‡§Ø‡§æ')"></textarea>
  </section>

  <aside class="terminal">
    <div class="card term-top"><div><div class="term-title">‡§ü‡§∞‡•ç‡§Æ‡§ø‡§®‡§≤ ‚Ä¢ ‡§Ü‡§â‡§ü‡§™‡•Å‡§ü</div></div></div>
    <div class="term-window"><div id="termOutput" class="term-output"><div class="stdout">‡§§‡•à‡§Ø‡§æ‡§∞ ‚Äî ‡§ï‡•ã‡§° ‡§ö‡§≤‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‚ñ∂ ‡§¶‡§¨‡§æ‡§è‡§Å‡•§</div></div></div>
    <div class="explain" id="explain">‡§Ø‡§π‡§æ‡§Å ‡§Ö‡§®‡•Å‡§µ‡§æ‡§¶ ‡§î‡§∞ ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ ‡§¶‡§ø‡§ñ‡§æ‡§à ‡§ú‡§æ‡§è‡§ó‡•Ä‡•§</div>
  </aside>
</main>

<div class="kb-toggle"><button class="btn" id="toggleKb">‚å® ‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§ï‡•Ä‡§¨‡•ã‡§∞‡•ç‡§°</button></div>
<div class="keyboard" id="keyboard" aria-hidden="true">
  <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
    <div style="font-weight:700">‡§π‡§ø‡§Ç‡§¶‡•Ä ‡§µ‡§∞‡•ç‡§ö‡•Å‡§Ö‡§≤ ‡§ï‡•Ä‡§¨‡•ã‡§∞‡•ç‡§°</div>
    <div style="display:flex;gap:8px;align-items:center">
      <div class="small hint">‡§∏‡§Ç‡§™‡§æ‡§¶‡§ï ‡§Æ‡•á‡§Ç ‡§∏‡•Ä‡§ß‡•á ‡§Ö‡§ï‡•ç‡§∑‡§∞ ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</div>
      <button class="btn" id="closeKb">‡§¨‡§Ç‡§¶ ‡§ï‡§∞‡•á‡§Ç</button>
    </div>
  </div>
  <div class="kb-rows" id="kbRows"></div>
</div>

<div id="suggestions"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.13/mode/python/python.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/skulpt@1.2.0/dist/skulpt.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/skulpt@1.2.0/dist/skulpt-stdlib.js"></script>

<script>
// --- Editor ---
let editor = CodeMirror.fromTextArea(document.getElementById('code'),{
  mode:'python',theme:'material-darker',lineNumbers:true,
  indentUnit:4,matchBrackets:true,autoCloseBrackets:true,tabSize:4
});

// --- Dictionary ---
const TRANSLATE = {
  '‡§Ö‡§ó‡§∞':'if','‡§Ö‡§®‡•ç‡§Ø‡§•‡§æ':'else','‡§Ö‡§®‡•ç‡§Ø‡§•‡§æ_‡§Ö‡§ó‡§∞':'elif','‡§ú‡§¨‡§§‡§ï':'while','‡§ï‡•á_‡§≤‡§ø‡§è':'for','‡§Æ‡•á‡§Ç':'in',
  '‡§™‡§æ‡§∏':'pass','‡§ú‡§æ‡§∞‡•Ä':'continue','‡§§‡•ã‡§°‡§º‡•á‡§Ç':'break','‡§´‡§ø‡§∞':'yield','‡§â‡§†‡§æ‡§ì':'raise',
  '‡§ï‡•ã‡§∂‡§ø‡§∂':'try','‡§™‡§ï‡§°‡§º‡•ã':'except','‡§Ö‡§Ç‡§§‡§§‡§É':'finally','‡§¶‡§æ‡§µ‡§æ':'assert','‡§∏‡§æ‡§•':'with','‡§ú‡•à‡§∏‡§æ':'as',
  '‡§™‡§∞‡§ø‡§≠‡§æ‡§∑‡§ø‡§§':'def','‡§µ‡§∞‡•ç‡§ó':'class','‡§µ‡§æ‡§™‡§∏_‡§ï‡§∞‡•á‡§Ç':'return','‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤':'global','‡§ó‡•à‡§∞‡§∏‡•ç‡§•‡§æ‡§®‡•Ä‡§Ø':'nonlocal','‡§≤‡•à‡§Æ‡•ç‡§¨‡•ç‡§°‡§æ':'lambda',
  '‡§∏‡§ö':'True','‡§ù‡•Ç‡§†':'False','‡§ï‡•Å‡§õ_‡§®‡§π‡•Ä‡§Ç':'None',
  '‡§î‡§∞':'and','‡§Ø‡§æ':'or','‡§®‡§π‡•Ä‡§Ç':'not','‡§π‡•à':'is',
  '‡§Ü‡§Ø‡§æ‡§§':'import','‡§∏‡•á':'from',
  '‡§õ‡§æ‡§™‡•á‡§Ç':'print','‡§á‡§®‡§™‡•Å‡§ü':'input','‡§≤‡§Ç‡§¨‡§æ‡§à':'len','‡§™‡•ç‡§∞‡§ï‡§æ‡§∞':'type','‡§∂‡•ç‡§∞‡•á‡§£‡•Ä':'range','‡§∏‡•Ç‡§ö‡•Ä':'list',
  '‡§∂‡§¨‡•ç‡§¶‡§ï‡•ã‡§∂':'dict','‡§∏‡§Æ‡•Å‡§ö‡•ç‡§ö‡§Ø':'set','‡§ü‡§™‡§≤':'tuple','‡§™‡•Ç‡§∞‡•ç‡§£‡§æ‡§Ç‡§ï':'int','‡§¶‡§∂‡§Æ‡§≤‡§µ':'float','‡§™‡§æ‡§†':'str','‡§ñ‡•ã‡§≤‡•á‡§Ç':'open',
  '‡§°‡•á‡§≤':'del','‡§π‡§ü‡§æ‡§è‡§Å':'del'
};
const TRAN_KEYS = Object.keys(TRANSLATE).sort((a,b)=>b.length-a.length).map(k=>({k,r:new RegExp('\\b'+k+'\\b','g')}));

// --- Translate Hindi to Python ---
function translateHindiToPython(hcode){
  let out=hcode;
  TRAN_KEYS.forEach(({k,r})=>{out=out.replace(r,TRANSLATE[k]);});
  out=out.replace(/[\u0966-\u096F]/g,d=>String.fromCharCode(d.charCodeAt(0)-0x0966+48));
  return out;
}

// --- Skulpt Run ---
function outf(text){const t=document.getElementById('termOutput');t.insertAdjacentHTML('beforeend','<div class="stdout">'+escapeHtml(text)+'</div>');t.scrollTop=t.scrollHeight;}
function errf(text){let msg=text;const t=document.getElementById('termOutput');t.insertAdjacentHTML('beforeend','<div class="stderr">'+escapeHtml(msg)+'</div>');t.scrollTop=t.scrollHeight;}
function builtinRead(x){if(Sk.builtinFiles===undefined||Sk.builtinFiles['files'][x]===undefined) throw "File not found: '"+x+"'";return Sk.builtinFiles['files'][x];}
function runSkulpt(pycode){const t=document.getElementById('termOutput');t.innerHTML='';Sk.configure({output:outf,read:builtinRead,stderr:errf});Sk.misceval.asyncToPromise(()=>Sk.importMainWithBody('<stdin>',false,pycode,true)).then(()=>outf('\n‚ü≤ ‡§®‡§ø‡§∑‡•ç‡§™‡§æ‡§¶‡§® ‡§∏‡§Æ‡§æ‡§™‡•ç‡§§‡•§')).catch(e=>errf(String(e)));}

// --- Live Error Check ---
function checkLiveErrors(code){
  const t = document.getElementById('termOutput');
  t.querySelectorAll('.live-error').forEach(e=>e.remove()); 
  Sk.configure({output:()=>{}, read: builtinRead});
  Sk.misceval.asyncToPromise(()=>Sk.importMainWithBody('<stdin>', false, code, true))
    .then(()=>{})
    .catch(e=>{
      const msg = e.toString().replace(/<stdin>/g,'');
      t.insertAdjacentHTML('afterbegin','<div class="stderr live-error">'+escapeHtml(msg)+'</div>');
    });
}

// --- Debounce ---
function debounce(func, wait){
  let timeout;
  return function(...args){
    clearTimeout(timeout);
    timeout = setTimeout(() => func.apply(this, args), wait);
  }
}

// --- Trigger live errors ---
editor.on("change", debounce(()=>{
  const raw = editor.getValue();
  const translated = translateHindiToPython(raw);
  checkLiveErrors(translated);
}, 500));

// --- Events ---
document.getElementById('runBtn').addEventListener('click',()=>{
  const raw=editor.getValue();
  const translated=translateHindiToPython(raw);
  document.getElementById('explain').textContent='‡§Ö‡§®‡•Å‡§µ‡§æ‡§¶‡§ø‡§§ ‡§™‡§æ‡§Ø‡§•‡§® ‡§ï‡•ã‡§°:\n\n'+translated;
  runSkulpt(translated);
});
document.getElementById('clearBtn').addEventListener('click',()=>{editor.setValue('');document.getElementById('termOutput').innerHTML='';document.getElementById('explain').textContent='‡§Ø‡§π‡§æ‡§Å ‡§Ö‡§®‡•Å‡§µ‡§æ‡§¶ ‡§î‡§∞ ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ ‡§¶‡§ø‡§ñ‡§æ‡§à ‡§ú‡§æ‡§è‡§ó‡•Ä‡•§'});
document.getElementById('examplesBtn').addEventListener('click',()=>{editor.setValue(‡§õ‡§æ‡§™‡•á‡§Ç('‡§®‡§Æ‡§∏‡•ç‡§§‡•á ‡§¶‡•Å‡§®‡§ø‡§Ø‡§æ!')
// \n‡§®‡§æ‡§Æ = '‡§Ø‡§∂'\n‡§â‡§Æ‡§∞ = ‡•®‡•´\n‡§õ‡§æ‡§™‡•á‡§Ç
('‡§®‡§æ‡§Æ:', ‡§®‡§æ‡§Æ, '‡§â‡§Æ‡§∞:', ‡§â‡§Æ‡§∞));});

// --- Suggestions ---
const suggestionBox = document.getElementById("suggestions");
function showSuggestions(prefix){
  suggestionBox.innerHTML="";
  if(!prefix) return;
  const matches=Object.keys(TRANSLATE).filter(w=>w.startsWith(prefix));
  matches.slice(0,5).forEach(word=>{
    const btn=document.createElement("button");
    btn.textContent=word;
    btn.onclick=()=>{insertWord(word);suggestionBox.innerHTML="";};
    suggestionBox.appendChild(btn);
  });
}
function insertWord(word){
  const cm=editor;const cursor=cm.getCursor();
  const line=cm.getLine(cursor.line);
  const start=line.lastIndexOf(' ',cursor.ch-1)+1;
  cm.replaceRange(word,{line:cursor.line,ch:start},cursor);
  cm.focus();
}
editor.on("inputRead",function(cm,change){
  if(change.text[0].match(/[‡§Ä-‡•ø]/)){ 
    const cursor=cm.getCursor();
    const line=cm.getLine(cursor.line);
    const lastWord=line.slice(0,cursor.ch).split(/\s+/).pop();
    showSuggestions(lastWord);
  } else { suggestionBox.innerHTML=""; }
});

// --- Voice Typing ---
let recognizing=false;
let recognition;
document.getElementById('voiceBtn').addEventListener('click',()=>{
  if(!('webkitSpeechRecognition' in window)){alert('‡§µ‡•â‡§á‡§∏ ‡§ü‡§æ‡§á‡§™‡§ø‡§Ç‡§ó ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º‡§∞ ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§∞‡•ç‡§•‡§ø‡§§ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à');return;}
  if(!recognition){
    recognition=new webkitSpeechRecognition();
    recognition.continuous=false;
    recognition.interimResults=false;
    recognition.lang='hi-IN';
    recognition.onresult=e=>{
      let transcript=e.results[0][0].transcript.trim();
      insertVoiceCode(transcript);
    };
    recognition.onend=()=>{recognizing=false;document.getElementById('voiceBtn').textContent='üé§ ‡§µ‡•â‡§á‡§∏ ‡§ü‡§æ‡§á‡§™‡§ø‡§Ç‡§ó';};
  }
  if(!recognizing){recognition.start();recognizing=true;document.getElementById('voiceBtn').textContent='üî¥ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°‡§ø‡§Ç‡§ó‚Ä¶';}
  else{recognition.stop();recognizing=false;document.getElementById('voiceBtn').textContent='üé§ ‡§µ‡•â‡§á‡§∏ ‡§ü‡§æ‡§á‡§™‡§ø‡§Ç‡§ó';}
});
function insertVoiceCode(text){
  text = text.replace(/[\p{P}\p{S}]/gu, ''); // remove punctuation & symbols
  const words = text.trim().split(/\s+/);
  let line = "";
  words.forEach(w => { line += w + " "; });
  const cm = editor;
  const cursor = cm.getCursor();
  cm.replaceRange(line, cursor);
  cm.focus();
}

// --- Virtual Keyboard ---
const KB_LAYOUT=[['‡•ß','‡•®','‡•©','‡•™','‡•´','‡•¨','‡•≠','‡•Æ','‡•Ø','‡•¶','backspace'],['‡§Ö','‡§Ü','‡§á','‡§à','‡§â','‡§ä','‡§ã','‡§è','‡§ê','‡§ì','‡§î'],['‡•ç','‡§æ','‡§ø','‡•Ä','‡•Å','‡•Ç','‡•É','‡•á','‡•à','‡•ã','‡•å','‡§Ç','‡§É','‡§º'],['‡§ï','‡§ñ','‡§ó','‡§ò','‡§ô','‡§ö','‡§õ','‡§ú','‡§ù','‡§û'],['‡§ü','‡§†','‡§°','‡§¢','‡§£','‡§§','‡§•','‡§¶','‡§ß','‡§®'],['‡§™','‡§´','‡§¨','‡§≠','‡§Æ','‡§Ø','‡§∞','‡§≤','‡§µ','‡§∂'],['‡§∑','‡§∏','‡§π','‡§ï‡•ç‡§∑','‡§§‡•ç‡§∞','‡§ú‡•ç‡§û','‡§∂‡•ç‡§∞'],['‡•§','‡••',',','.','(',')','=','space','enter']];
function buildKeyboard(){const kbRows=document.getElementById('kbRows');kbRows.innerHTML='';KB_LAYOUT.forEach(row=>{const rowEl=document.createElement('div');rowEl.className='kb-row';row.forEach(key=>{const k=document.createElement('div');k.className='kb-key';if(key==='space'){k.classList.add('wide');k.textContent='‡§∏‡•ç‡§™‡•á‡§∏';}else if(key==='enter'){k.classList.add('func','wide');k.textContent='‡§è‡§Ç‡§ü‡§∞';}else if(key==='backspace'){k.classList.add('func');k.textContent='‚å´ ‡§π‡§ü‡§æ‡§è‡§Å';}else{k.textContent=key;}k.dataset.key=key;k.addEventListener('click',onKeyClick);rowEl.appendChild(k);});kbRows.appendChild(rowEl);});}
function onKeyClick(e){const key=e.currentTarget.dataset.key;const doc=editor.getDoc();const cursor=doc.getCursor();if(key==='backspace'){if(cursor.ch>0) doc.replaceRange('',{line:cursor.line,ch:cursor.ch-1},cursor);}else if(key==='enter'){doc.replaceRange('\n',cursor);}else if(key==='space'){doc.replaceRange(' ',cursor);}else{doc.replaceRange(key,cursor);}editor.focus();}
const keyboard=document.getElementById('keyboard');
document.getElementById('toggleKb').addEventListener('click',()=>{keyboard.classList.toggle('open');});
document.getElementById('closeKb').addEventListener('click',()=>{keyboard.classList.remove('open');});
buildKeyboard();

// --- Utils ---
function escapeHtml(s){return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');}
</script>
</body>
</html>